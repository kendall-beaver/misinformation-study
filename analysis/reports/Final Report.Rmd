---
title: "Graduate Capstone Report"
author: "Kendall Beaver"
date: "`r Sys.Date()`"
output: pdf_document
---

```{r load_libraries, tidy=TRUE, message=FALSE, warning=FALSE, results='hide', echo=FALSE}

#{r setup, include=FALSE}
#knitr::opts_chunk$set(echo = TRUE)

# Load libraries
library(tidyr)
library(grid)
library(gridExtra)
library(readxl)
library(dplyr)
library(corrplot)
library(writexl)
library(ggplot2)
library(stringr)
library(scales)
library(patchwork)
#library(gt)

# Load datasets

lying <- read_excel("../data/lying_data.xlsx")
```

# Intro

This report critically assessed 594 written responses that were collected from 99 participants via a questionnaire in Dr. Diana Daly's pilot study, "Design of audio ads to prebunk misinformation and promote civil discourse", where participants were asked the following qualitative questions ("QQ"):

-   QQ1: What are some reasons you think people are attracted to radical groups?

-   QQ2: What are some reasons you think people believe false ideas circulating online?

-   QQ3: Describe a situation in which supporting friends would be more important than telling the truth.

These questions were asked before and after an ad was presented to a participant, which could be one of four ads: a control ad in an audio or visual-audio format, or a test ad in an audio or visual-audio format. The former ad was a random ad, whereas the latter was an experimental ad designed to increase participants' information literacy and make them more skeptical about misinformation. In addition to QQ1 - QQ3, participants were asked what they liked and disliked about their ad, plus any additional thoughts they had about said ad.

Thematic and content analysis was performed on the responses to identify common theme. Every response was thoroughly reviewed several times, and if the meaning of a response still could not be understood after this process, the response was placed in the "Other" category—different from the "Unsure" category, where participants explicitly stated that they were unsure and did not have an answer for a QQ.

A composite score was also developed to measure how much a person's response changed to each QQ, by taking the count of words and sentences before and after an ad, normalizing the counts to make them equivalent, adding them together, then dividing by two to produce an average score.

$$
\frac{\text{Normalized count of words} + \text{Normalized count of sentences}}{2}
$$

In summary, participants' views remained mostly unchanged before and after an ad, except for QQ1, which had 9 categories (the most amount of categories for any QQ) and the largest amount of change. Additionally, the composite score always increased whenever participants were show an audio-visual ad, whether a control or test ad, and when the data was analyzed based on gender instead of ad group, there were slight contrasting views in how males and females answered a question.

This report is organized and presented in four main sections: I. Categorical Responses for QQ1 - QQ3; II. Composite Score for QQ1 - QQ3; III. Sentiment Analysis of Each Ad; and IV. Limitations and Future Discussions.

# I. Categorical Responses for QQ1 - QQ3

## QQ1

A total of 9 common themes were identified in the responses to QQ1, which are nearly twice as long as the themes identified in QQ2 & QQ3, and this could be due to the nature of the question—trying to understand the thoughts of somebody different than the participant and why they would be interested in joining a radical group. If a theme appeared at least 3 times then it was assigned its own category, but many themes were combined together if they had an influence on one another, helping to produce a more concise list.

### "What are some reasons you think people are attracted to radical groups?"

1.  Coerced into joining group.

2.  Influenced to join a group in a non-coercive manner.

3.  Drawn to narcissists; to people who are passionate, confident, and charismatic.

4.  Confirmation bias; wanting to be part of a community of like-minded people, to not feel lonely.

5.  Feeling helpless and believe in the group's cause; that they can make change and life better.

6.  Curious about checking out the group; group seems large, powerful and different; could be fun, could gain status; to not feel bored.

7.  Are narcissists themselves and want to influence or have power over people; enjoy expressing their views.

8.  Unsure why people are attracted to radical groups.

9.  Other; response is too broad, unclear, and/or doesn't match any other categories.

Figures 1 & 2 below show the results of these categories changed after presenting an ad.

```{r control_group_plot, fig.width=5.5, fig.height=3.5, fig.align="center", tidy=TRUE, message=FALSE, warning=FALSE, echo=FALSE}

### CONTROL GROUP PLOT ###

# Step 1: Reshape, include GROUP, relabel columns
type_of_lie_long <- lying %>%
  select(GROUP, QQ1_CATEGORY_BEFORE, QQ1_CATEGORY_AFTER) %>%
  pivot_longer(cols = c(QQ1_CATEGORY_BEFORE, QQ1_CATEGORY_AFTER),
               names_to = "QuestionType",
               values_to = "Response") %>%
  drop_na() %>%
  mutate(QuestionType = recode(QuestionType,
                               QQ1_CATEGORY_BEFORE = "Before Ad",
                               QQ1_CATEGORY_AFTER = "After Ad")) %>%
  mutate(Response = str_split(Response, ";\\s*")) %>%
  unnest(Response) %>%
  mutate(Response = str_trim(Response))

# Step 2: Count and calculate percentages grouped by GROUP and QuestionType
lie_counts <- type_of_lie_long %>%
  group_by(GROUP, QuestionType, Response) %>%
  summarise(n = n(), .groups = "drop") %>%
  group_by(GROUP, QuestionType) %>%
  mutate(perc = n / sum(n) * 100)

# Step 3: Set factor levels for consistent x-axis order
lie_counts$QuestionType <- factor(lie_counts$QuestionType, levels = c("Before Ad", "After Ad"))

# Step 4: Filter for Control Group
control_groups <- lie_counts %>%
  filter(GROUP %in% c("Control Group (Visual)", "Control Group (Audio)"))

# Step 5: Create Control plot
plot_control <- ggplot(control_groups, aes(x = QuestionType, y = perc, fill = Response)) +
  geom_bar(stat = "identity", position = "stack", color = "black") +
  geom_text(aes(label = paste0(round(perc, 1), "%")),
            position = position_stack(vjust = 0.5),
            size = 3, fontface = "bold", color = "black") +
  labs(x = "\nResponses", y = "Percentage\n",) + # title = "Control Groups"
  facet_wrap(~ GROUP) +
  theme_minimal()

# Step 6: Create the caption text
caption <- textGrob("Figure 1: Control Group (Visual & Audio) responses before and after the ad.", 
                    gp = gpar(fontsize = 10))

# Step 7: Combine the plot and caption using grid.arrange()
grid.arrange(plot_control, caption, ncol = 1, heights = c(10, 1))
```

```{r test_group_plot, fig.width=5.5, fig.height=4, fig.align="center", tidy=TRUE, message=FALSE, warning=FALSE, echo=FALSE}

### TEST GROUP PLOT ###

# Step 4: Filter for Test Group
test_groups <- lie_counts %>%
  filter(GROUP %in% c("Test Group (Visual)", "Test Group (Audio)"))

# Step 5: Create Test plot
plot_test <- ggplot(test_groups, aes(x = QuestionType, y = perc, fill = Response)) +
  geom_bar(stat = "identity", position = "stack", color = "black") +
  geom_text(aes(label = paste0(round(perc, 1), "%")),
            position = position_stack(vjust = 0.5),
            size = 3, fontface = "bold", color = "black") +
  labs(x = "\nResponses", y = "Percentage\n",) + #  title = "Test Groups"
  facet_wrap(~ GROUP) +
  theme_minimal()

# Step 6: Create the caption text
caption <- textGrob("Figure 2: Test Group (Visual & Audio) responses before and after the ad.", 
                    gp = gpar(fontsize = 10))

# Step 7: Combine the plot and caption using grid.arrange()
grid.arrange(plot_test, caption, ncol = 1, heights = c(10, 1))
```

The largest category for both ad groups was Category 4 ("Confirmation bias"), which composed over 40% of all responses for participants. However, this response decreased on average by 7.07% after the control ad was presented, whereas responses increased by 28.21% on average after the test ad was presented to those participants.

In the latter ad, a female character named Mel finds a group of online friends who want to storm the post office, but in the former ad a female character named Jessica doesn't say that her friends are radical in any way, only that they're "early bowlers." It's possible that the ad with radical friends could have influenced the responses, but follow-up survey data and/or interviews need to be conducted to validate this.

The second largest category for the control ad was Category 5 ("Believe group can make their life better") before the ad, then was tied and shared equally with Category 6 ("Group seems large, powerful and different; could be fun") after the ad. Regarding the audio ad, Category 5 was the second largest category for the audio group while Category 3 ("Drawn to narcassists") held the same ranking for the visual group. After the ad was presented, Category 1 ("Coerced into joining group") took second place for the audio group while Categories 6 & 9 ("Other; response is too broad") equally took second place for the visual group.

## QQ2

6 themes were identified in this category.

###  "What are some reasons you think people believe false ideas circulating online?"

1.  Doesn't take time to fact check.

2.  Believes first thing they see.

3.  Looks for ideas that confirm pre-existing beliefs.

4.  Unsure. (This only appears in 1 of the 4 ads.)

5.  Other.

6.  There's too much misinformation available.

```{r control_group_qq2, fig.width=6, fig.height=4, fig.align="center", tidy=TRUE, message=FALSE, warning=FALSE, echo=FALSE}

### CONTROL GROUP: QQ2 Responses

# Reshape, filter for Control Group
control_long <- lying %>%
  select(GROUP, QQ2_CATEGORY_BEFORE, QQ2_CATEGORY_AFTER) %>%
  filter(GROUP %in% c("Control Group (Visual)", "Control Group (Audio)")) %>%
  pivot_longer(cols = c(QQ2_CATEGORY_BEFORE, QQ2_CATEGORY_AFTER),
               names_to = "QuestionType",
               values_to = "Response") %>%
  drop_na() %>%
  mutate(QuestionType = recode(QuestionType,
                               QQ2_CATEGORY_BEFORE = "Before Ad",
                               QQ2_CATEGORY_AFTER = "After Ad")) %>%
  mutate(Response = str_split(Response, ";\\s*")) %>%
  unnest(Response) %>%
  mutate(Response = str_trim(Response))

# Relabel responses
response_labels <- c(
  "1" = "Doesn't take time to fact check",
  "2" = "Believes first thing they see",
  "3" = "Looks for ideas that confirm\npre-existing beliefs",
  "4" = "Unsure",
  "5" = "Other",
  "6" = "There's too much\nmisinformation available"
)

control_long <- control_long %>%
  mutate(Response = recode(Response, !!!response_labels))

# Count and percentage
control_counts <- control_long %>%
  group_by(GROUP, QuestionType, Response) %>%
  summarise(n = n(), .groups = "drop") %>%
  group_by(GROUP, QuestionType) %>%
  mutate(perc = n / sum(n) * 100)

control_counts$QuestionType <- factor(control_counts$QuestionType, levels = c("Before Ad", "After Ad"))

# Plot
third_plot <- ggplot(control_counts, aes(x = QuestionType, y = perc, fill = Response)) +
  geom_bar(stat = "identity", position = "stack", color = "black") +
  geom_text(aes(label = paste0(round(perc, 1), "%")),
            position = position_stack(vjust = 0.5), size = 3, color = "black") +
  labs(x = "\nResponses", y = "Percentage\n", fill = "Common Themes") +
  facet_wrap(~ GROUP) +
  theme_minimal()

# Step 6: Create the caption text
caption <- textGrob("Figure 3: Control Group Responses Before and After the Ad", 
                    gp = gpar(fontsize = 10))

# Step 7: Combine the plot and caption using grid.arrange()
grid.arrange(third_plot, caption, ncol = 1, heights = c(10, 1))
```

```{r test_group_qq2, fig.width=6, fig.height=4, fig.align="center", tidy=TRUE, message=FALSE, warning=FALSE, echo=FALSE}

### TEST GROUP: QQ2 Responses

# Reshape, filter for Test Group
test_long <- lying %>%
  select(GROUP, QQ2_CATEGORY_BEFORE, QQ2_CATEGORY_AFTER) %>%
  filter(GROUP %in% c("Test Group (Visual)", "Test Group (Audio)")) %>%
  pivot_longer(cols = c(QQ2_CATEGORY_BEFORE, QQ2_CATEGORY_AFTER),
               names_to = "QuestionType",
               values_to = "Response") %>%
  drop_na() %>%
  mutate(QuestionType = recode(QuestionType,
                               QQ2_CATEGORY_BEFORE = "Before Ad",
                               QQ2_CATEGORY_AFTER = "After Ad")) %>%
  mutate(Response = str_split(Response, ";\\s*")) %>%
  unnest(Response) %>%
  mutate(Response = str_trim(Response))

# Reuse the same labels
test_long <- test_long %>%
  mutate(Response = recode(Response, !!!response_labels))

# Count and percentage
test_counts <- test_long %>%
  group_by(GROUP, QuestionType, Response) %>%
  summarise(n = n(), .groups = "drop") %>%
  group_by(GROUP, QuestionType) %>%
  mutate(perc = n / sum(n) * 100)

test_counts$QuestionType <- factor(test_counts$QuestionType, levels = c("Before Ad", "After Ad"))

# Plot
fourth_plot <- ggplot(test_counts, aes(x = QuestionType, y = perc, fill = Response)) +
  geom_bar(stat = "identity", position = "stack", color = "black") +
  geom_text(aes(label = paste0(round(perc, 1), "%")),
            position = position_stack(vjust = 0.5), size = 3, color = "black") +
  labs(x = "\nResponses", y = "Percentage\n", fill = "Common Themes") +
  facet_wrap(~ GROUP) +
  theme_minimal()

# Step 6: Create the caption text
caption <- textGrob("Figure 4: Control Group Responses Before and After the Ad", 
                    gp = gpar(fontsize = 10))

# Step 7: Combine the plot and caption using grid.arrange()
grid.arrange(fourth_plot, caption, ncol = 1, heights = c(10, 1))
```

## QQ3: "Describe a situation in which supporting friends would be more important than telling the truth."

```{r}

```

## Overall Effect

```{r}

```

# Composite Score for QQ1 - QQ3

```{r}

```

# Sentiment Analysis of Each Ad

```{r}

```

# Other Project?

This didn't pan out. The link is here, and is in the GitHub repository:

# Limitations/Findings/Future Discussions

### Cut stuff:

Additionally, if a different advertisement was presented to participants then the views may or may not change based on the emotional impact an ad may have. The thematic analysis is also the views, as objective as possible, of just one person.

This will be good to create categories for quicker analysis, especially if multiple studies want to be ran at once, and scaled up to occur more frequently. This pilot is a starting point, and additional comments can be left.

In summary, no correlation was found between the type of ad and categorical responses changing, although the composite score always increased whenever participants were show an audio-visual ad, whether a control or test ad. When the data was analyzed based on gender instead of ad group, there were slight contrasting views in how males and females answered a question, but overall, participants' views remained mostly unchanged before and after an ad.

Many themes were combined together that have some type of relationship and influence on one another. For example,

the categories in QQ1 have been combined that has some influence on each other. For example, with the largest category, 4 - Confirmation bias, people want to seek a community of like-minded people, "confirmation bias" means they're seeking people and sources that match their views. In other words, misinformation usually isn't objective and factual, but information that has been filtered subjectively or completely made up and seems real.

This question asked people their views on relationships, specifically how people form social bonds with radical people, therefore it's possible that many themes appeared to explain this complex, multi-faceted dynamic.
