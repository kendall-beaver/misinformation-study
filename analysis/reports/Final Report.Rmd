---
title: "Graduate Capstone Report"
author: "Kendall Beaver"
date: "`r Sys.Date()`"
output: pdf_document
---

```{r load_libraries, tidy=TRUE, message=FALSE, warning=FALSE, results='hide', echo=FALSE}

#{r setup, include=FALSE}
#knitr::opts_chunk$set(echo = TRUE)

# Load libraries
library(tidyr)
library(grid)
library(gridExtra)
library(readxl)
library(dplyr)
library(corrplot)
library(writexl)
library(ggplot2)
library(stringr)
library(scales)
library(patchwork)
library(formattable)
library(htmltools)
library(htmlwidgets)
library(webshot)
library(formattable)
library(kableExtra)
#library(gt)

# Load datasets

lying <- read_excel("../data/lying_data.xlsx")
```

# Intro

This report contains the assessment and critical analysis of 594 written responses that were collected from 99 participants via a questionnaire in Dr. Diana Daly's pilot study, "Design of audio ads to prebunk misinformation and promote civil discourse", where participants were asked the following qualitative questions ("QQ"):

-   QQ1: What are some reasons you think people are attracted to radical groups?

-   QQ2: What are some reasons you think people believe false ideas circulating online?

-   QQ3: Describe a situation in which supporting friends would be more important than telling the truth.

These questions were asked before and after an ad was presented to a participant, which could be one of four ads: a control ad in an audio or visual-audio format, or a test ad in an audio or visual-audio format. The former ad was a random ad, whereas the latter was an experimental ad designed to increase participants' information literacy and make them more skeptical about misinformation. In addition to QQ1 - QQ3, participants were asked what they liked and disliked about their ad, plus any additional thoughts they had about said ad.

Thematic and content analysis was performed on the responses to identify common theme. Every response was thoroughly reviewed several times, and if the meaning of a response still could not be understood after this process, the response was placed in the "Other" category—different from the "Unsure" category, where participants explicitly stated that they were unsure and did not have an answer for a QQ.

A composite score was also developed to measure how much a person's response changed to each QQ, by taking the count of words and sentences before and after an ad, normalizing the counts to make them equivalent, adding them together, then dividing by two to produce an average score.

$$
\frac{\text{Normalized count of words} + \text{Normalized count of sentences}}{2}
$$

In summary, participants' views remained mostly unchanged before and after an ad, except for QQ1, which had 9 categories (the most amount of categories for any QQ) and the largest amount of change. Additionally, the composite score always increased whenever participants were show an audio-visual ad, whether a control or test ad, and when the data was analyzed based on gender instead of ad group, there were slight contrasting views in how males and females answered a question.

This report is organized and presented in four main sections: I. Categorical Responses for QQ1 - QQ3; II. Composite Score for QQ1 - QQ3; III. Sentiment Analysis of Ads; and IV. Limitations and Future Discussions.

# I. Categorical Responses for QQ1 - QQ3

## QQ1

A total of 9 common themes were identified in the responses for QQ1, the largest amount of themes for all QQs, and this could be due to the nature of the question—trying to understand the thoughts of somebody different than the participant and why they would be interested in joining a radical group. If a theme appeared at least 3 times then it was assigned its own category, but many themes were combined together if they had an influence on one another, helping to produce a more concise list.

### "What are some reasons you think people are attracted to radical groups?"

1.  Coerced into joining group

2.  Influenced to join a group in a non-coercive manner

3.  Drawn to narcissists; to people who are passionate, confident, and charismatic

4.  Confirmation bias; wanting to be part of a community of like-minded people, to not feel lonely

5.  Feeling helpless and believe in the group's cause; that they can make change and life better

6.  Curious about checking out the group; group seems large, powerful and different; could be fun, could gain status; to not feel bored

7.  Are narcissists themselves and want to influence or have power over people; enjoy expressing their views

8.  Unsure why people are attracted to radical groups

9.  Other; response is too broad, unclear, and/or doesn't match any other categories

Figures 1 & 2 below show the results of these categories changed after presenting an ad

```{r control_group_plot, fig.width=5.5, fig.height=3.5, fig.align="center", tidy=TRUE, message=FALSE, warning=FALSE, echo=FALSE}

### CONTROL GROUP PLOT ###

# Step 1: Reshape, include GROUP, relabel columns
type_of_lie_long <- lying %>%
  select(GROUP, QQ1_CATEGORY_BEFORE, QQ1_CATEGORY_AFTER) %>%
  pivot_longer(cols = c(QQ1_CATEGORY_BEFORE, QQ1_CATEGORY_AFTER),
               names_to = "QuestionType",
               values_to = "Response") %>%
  drop_na() %>%
  mutate(QuestionType = recode(QuestionType,
                               QQ1_CATEGORY_BEFORE = "Before Ad",
                               QQ1_CATEGORY_AFTER = "After Ad")) %>%
  mutate(Response = str_split(Response, ";\\s*")) %>%
  unnest(Response) %>%
  mutate(Response = str_trim(Response))

# Step 2: Count and calculate percentages grouped by GROUP and QuestionType
lie_counts <- type_of_lie_long %>%
  group_by(GROUP, QuestionType, Response) %>%
  summarise(n = n(), .groups = "drop") %>%
  group_by(GROUP, QuestionType) %>%
  mutate(perc = n / sum(n) * 100)

# Step 3: Set factor levels for consistent x-axis order
lie_counts$QuestionType <- factor(lie_counts$QuestionType, levels = c("Before Ad", "After Ad"))

# Step 4: Filter for Control Group
control_groups <- lie_counts %>%
  filter(GROUP %in% c("Control Group (Visual)", "Control Group (Audio)"))

# Step 5: Create Control plot
plot_control <- ggplot(control_groups, aes(x = QuestionType, y = perc, fill = Response)) +
  geom_bar(stat = "identity", position = "stack", color = "black") +
  geom_text(aes(label = paste0(round(perc, 1), "%")),
            position = position_stack(vjust = 0.5),
            size = 3, fontface = "bold", color = "black") +
  labs(x = "\nResponses", y = "Percentage\n", fill = "Category") + # title = "Control Groups"
  facet_wrap(~ GROUP) +
  theme_minimal()

# Step 6: Create the caption text
caption <- textGrob("Figure 1: Control group (visual & audio) responses to QQ1 before and after ad.", 
                    gp = gpar(fontsize = 10))

# Step 7: Combine the plot and caption using grid.arrange()
#grid.arrange(plot_control, caption, ncol = 1, heights = c(10, 1))

# Arrange the plot and caption
arranged_grob <- arrangeGrob(plot_control, caption, ncol = 1, heights = c(10, 1))

# Draw a border and plot the arranged grobs
grid.newpage()
grid.draw(
  grobTree(
    rectGrob(gp = gpar(fill = NA, col = "black", lwd = 2)),  # This adds the border
    arranged_grob
  )
)
```

```{r test_group_plot, fig.width=5.5, fig.height=4, fig.align="center", tidy=TRUE, message=FALSE, warning=FALSE, echo=FALSE}

### TEST GROUP PLOT ###

# Step 4: Filter for Test Group
test_groups <- lie_counts %>%
  filter(GROUP %in% c("Test Group (Visual)", "Test Group (Audio)"))

# Step 5: Create Test plot
plot_test <- ggplot(test_groups, aes(x = QuestionType, y = perc, fill = Response)) +
  geom_bar(stat = "identity", position = "stack", color = "black") +
  geom_text(aes(label = paste0(round(perc, 1), "%")),
            position = position_stack(vjust = 0.5),
            size = 3, fontface = "bold", color = "black") +
  labs(x = "\nResponses", y = "Percentage\n", fill = "Category") + #  title = "Test Groups"
  facet_wrap(~ GROUP) +
  theme_minimal()

# Step 6: Create the caption text
caption <- textGrob("Figure 2: Test group (visual & audio) responses to QQ1 before and after ad.", 
                    gp = gpar(fontsize = 10))

# Step 7: Combine the plot and caption using grid.arrange()
#grid.arrange(plot_test, caption, ncol = 1, heights = c(10, 1))

# Arrange the plot and caption
arranged_grob <- arrangeGrob(plot_test, caption, ncol = 1, heights = c(10, 1))

# Draw a border and plot the arranged grobs
grid.newpage()
grid.draw(
  grobTree(
    rectGrob(gp = gpar(fill = NA, col = "black", lwd = 2)),  # This adds the border
    arranged_grob
  )
)
```

The largest category for both ad groups was Category 4 ("Confirmation bias"), which composed over 40% of all responses for participants. However, this response decreased on average by 7.07% after the control ad was presented, whereas responses increased by 28.21% on average after the test ad was presented to those participants.

In the latter ad, a female character named Mel finds a group of online friends who want to storm the post office, but in the former ad a female character named Jessica doesn't say that her friends are radical in any way, only that they're "early bowlers." It's possible that the ad with radical friends could have influenced the responses, but follow-up survey data and/or interviews need to be conducted to validate this.

The second largest category for the control ad was Category 5 ("Believe group can make their life better") before the ad, at 25.9% for the audio group and 20% for the visual group, then was tied and shared equally with Category 6 ("Group seems large, powerful and different; could be fun") post-ad, at 15.4% for the audio group and 18.2% for the visual group (Figure 1).

Regarding the audio ad, Category 5 was the second largest category for the audio group, at 11.1%, while Category 3 ("Drawn to narcassists") held the same ranking for the visual group, at 10%. But after the ad was presented, Category 1 ("Coerced into joining group") took second place for the audio group, at 9.7%, while Categories 6 & 9 ("Other; response is too broad") equally shared second place for the visual group, at 12.1% (Figure 2).

## QQ2

6 main themes were identified for QQ2 and appeared in all groups except for Category 4 ("Unsure"), which appeared once for the test ad - visual group, as shown in Figure 4.

### "What are some reasons you think people believe false ideas circulating online?"

1.  Doesn't take time to fact check

2.  Believes first thing they see

3.  Looks for ideas that confirm pre-existing beliefs

4.  Unsure

5.  Other

6.  There's too much misinformation available

Categories 1 ("Doesn't take time to fact check"), 2 ("Believes first thing they see") & 3 ("Looks for ideas that confirm existing beliefs") occupied the first three places across all ad groups, but in different variations. As shown in Figure 3, Category 3 held the top spot at 32.1% for the control ad - audio group, but was replaced by Category 1 post-ad, at 33.3%. For the visual group, Categories 1 & 2 shared first place at 31%, until Category 1 became the top response post-ad, at 38.7%.

```{r control_group_qq2, fig.width=6, fig.height=4, fig.align="center", tidy=TRUE, message=FALSE, warning=FALSE, echo=FALSE}

### CONTROL GROUP: QQ2 Responses

# Reshape, filter for Control Group
control_long <- lying %>%
  select(GROUP, QQ2_CATEGORY_BEFORE, QQ2_CATEGORY_AFTER) %>%
  filter(GROUP %in% c("Control Group (Visual)", "Control Group (Audio)")) %>%
  pivot_longer(cols = c(QQ2_CATEGORY_BEFORE, QQ2_CATEGORY_AFTER),
               names_to = "QuestionType",
               values_to = "Response") %>%
  drop_na() %>%
  mutate(QuestionType = recode(QuestionType,
                               QQ2_CATEGORY_BEFORE = "Before Ad",
                               QQ2_CATEGORY_AFTER = "After Ad")) %>%
  mutate(Response = str_split(Response, ";\\s*")) %>%
  unnest(Response) %>%
  mutate(Response = str_trim(Response))

# Relabel responses
response_labels <- c(
  "1" = "Doesn't take time to fact check",
  "2" = "Believes first thing they see",
  "3" = "Looks for ideas that confirm\npre-existing beliefs",
  "4" = "Unsure",
  "5" = "Other",
  "6" = "There's too much\nmisinformation available"
)

control_long <- control_long %>%
  mutate(Response = recode(Response, !!!response_labels))

# Count and percentage
control_counts <- control_long %>%
  group_by(GROUP, QuestionType, Response) %>%
  summarise(n = n(), .groups = "drop") %>%
  group_by(GROUP, QuestionType) %>%
  mutate(perc = n / sum(n) * 100)

control_counts$QuestionType <- factor(control_counts$QuestionType, levels = c("Before Ad", "After Ad"))

# Plot
third_plot <- ggplot(control_counts, aes(x = QuestionType, y = perc, fill = Response)) +
  geom_bar(stat = "identity", position = "stack", color = "black") +
  geom_text(aes(label = paste0(round(perc, 1), "%")),
            position = position_stack(vjust = 0.5), size = 3, color = "black") +
  labs(x = "\nResponses", y = "Percentage\n", fill = "Category") +
  facet_wrap(~ GROUP) +
  theme_minimal()

# Create the caption text
caption <- textGrob("Figure 3: Control group (visual & audio) responses to QQ2 before and after ad.", 
                    gp = gpar(fontsize = 10))

# Arrange the plot and caption
arranged_grob <- arrangeGrob(third_plot, caption, ncol = 1, heights = c(10, 1))

# Draw a border and plot the arranged grobs
grid.newpage()
grid.draw(
  grobTree(
    rectGrob(gp = gpar(fill = NA, col = "black", lwd = 2)),  # This adds the border
    arranged_grob
  )
)
```

For the test ad, Category 1 was the dominant category for the audio and visual group, at 34.4% and 43.2%, respectively, and remained in the top spot for the visual group post-ad, increasing to 47.5%, but decreased to 26.3% for the audio group post-ad and was overtaken by Category 2, which gained a slight lead of 28.9% (Figure 4).

```{r test_group_qq2, fig.width=6, fig.height=4, fig.align="center", tidy=TRUE, message=FALSE, warning=FALSE, echo=FALSE}

### TEST GROUP: QQ2 Responses

# Reshape, filter for Test Group
test_long <- lying %>%
  select(GROUP, QQ2_CATEGORY_BEFORE, QQ2_CATEGORY_AFTER) %>%
  filter(GROUP %in% c("Test Group (Visual)", "Test Group (Audio)")) %>%
  pivot_longer(cols = c(QQ2_CATEGORY_BEFORE, QQ2_CATEGORY_AFTER),
               names_to = "QuestionType",
               values_to = "Response") %>%
  drop_na() %>%
  mutate(QuestionType = recode(QuestionType,
                               QQ2_CATEGORY_BEFORE = "Before Ad",
                               QQ2_CATEGORY_AFTER = "After Ad")) %>%
  mutate(Response = str_split(Response, ";\\s*")) %>%
  unnest(Response) %>%
  mutate(Response = str_trim(Response))

# Reuse the same labels
test_long <- test_long %>%
  mutate(Response = recode(Response, !!!response_labels))

# Count and percentage
test_counts <- test_long %>%
  group_by(GROUP, QuestionType, Response) %>%
  summarise(n = n(), .groups = "drop") %>%
  group_by(GROUP, QuestionType) %>%
  mutate(perc = n / sum(n) * 100)

test_counts$QuestionType <- factor(test_counts$QuestionType, levels = c("Before Ad", "After Ad"))

# Plot
fourth_plot <- ggplot(test_counts, aes(x = QuestionType, y = perc, fill = Response)) +
  geom_bar(stat = "identity", position = "stack", color = "black") +
  geom_text(aes(label = paste0(round(perc, 1), "%")),
            position = position_stack(vjust = 0.5), size = 3, color = "black") +
  labs(x = "\nResponses", y = "Percentage\n", fill = "Category") +
  facet_wrap(~ GROUP) +
  theme_minimal()

# Step 6: Create the caption text
caption <- textGrob("Figure 4: Test group (visual & audio) responses to QQ2 before and after ad.", 
                    gp = gpar(fontsize = 10))

# Step 7: Combine the plot and caption using grid.arrange()
#grid.arrange(fourth_plot, caption, ncol = 1, heights = c(10, 1))

# Arrange the plot and caption
arranged_grob <- arrangeGrob(fourth_plot, caption, ncol = 1, heights = c(10, 1))

# Draw a border and plot the arranged grobs
grid.newpage()
grid.draw(
  grobTree(
    rectGrob(gp = gpar(fill = NA, col = "black", lwd = 2)),  # This adds the border
    arranged_grob
  )
)
```

## QQ3

This question had the least amount of categories for all QQs, yet contained the most interesting discovery when the data was split by gender instead of ad group. Before the gender findings are discussed, the 4 main categories identified in QQ3 will be discussed and presented first.

### "Describe a situation in which supporting friends would be more important than telling the truth."

1.  Protect friend from danger and/or punishment

2.  Unsure

3.  White lie

4.  Would tell truth over supporting friends

Unlike the previous QQs which asked open-ended questions, QQ3 asked participants to describe a scenario in which lying would be okay to support friends. All of the responses could fit into 1 of 4 categories, indicating that there isn't a variation with lying in this type of situation, and none of the answers were ambiguous enough to create an "Other" category, making this the only QQ to not have that category.

Figure 5 shows that the largest response for all groups before and after the ad, overwhelmingly, was Category 3 ("White lie"), hovering between 62% - 82% before the ad and 67% - 82% after the ad. Category 1 ("Protect friend from danger and/or punishment") remained the second largest category for 3 out of 4 groups (control ad - audio & visual groups; test ad - visual group), ranging from 13.6% - 21.4%, while Category 4 ("Would tell truth over supporting friends") took second place for the test ad - audio group at 14.3% before the ad, and sharing this same percentage and ranking with Category 1 post-ad.

```{r figure_five, fig.align="center", tidy=TRUE, message=FALSE, warning=FALSE, results='hide', echo=FALSE}

### PLOT 3: Faceted by Group (Test vs. Control) ###

# Step 1: Reshape with group
type_of_lie_long_group <- lying %>%
  select(GROUP, QQ3_TYPE_OF_LIE, QQ3_LIE_2_SUMMARY) %>%
  pivot_longer(cols = c(QQ3_TYPE_OF_LIE, QQ3_LIE_2_SUMMARY),
               names_to = "QuestionType",
               values_to = "Response") %>%
  drop_na() %>%
  mutate(QuestionType = recode(QuestionType,
                               QQ3_TYPE_OF_LIE = "Before Ad",
                               QQ3_LIE_2_SUMMARY = "After Ad"))

# Step 2: Count and percentage
lie_counts_group <- type_of_lie_long_group %>%
  group_by(GROUP, QuestionType, Response) %>%
  summarise(n = n(), .groups = "drop") %>%
  group_by(GROUP, QuestionType) %>%
  mutate(perc = n / sum(n) * 100)

# Step 3: Set factor levels
lie_counts_group$QuestionType <- factor(lie_counts_group$QuestionType, levels = c("Before Ad", "After Ad"))

# Step 3b: Define mapping for legend labels with line breaks
response_labels <- c(
  "White Lie" = "White lie",
  "Keeping friend from danger and/or punishment" = "Protect friend from danger\nand/or punishment",
  "Would tell truth over supporting friends" = "Would tell truth over\nsupporting friends",
  "Unsure" = "Unsure"
)

# Step 4: Create faceted plot
plot_group <- ggplot(lie_counts_group, aes(x = QuestionType, y = perc, fill = Response)) +
  geom_bar(stat = "identity", position = "stack", color = "black") +
  geom_text(aes(label = paste0(round(perc, 1), "%")),
            position = position_stack(vjust = 0.5), size = 3, color = "black") +
  labs(#title = "QQ3 Responses Before vs. After Ad (Control vs. Test Group)",
       x = "\nResponses",
       y = "Percentage\n",
       fill = "Category") +
  facet_wrap(~ GROUP) +
  theme_minimal() +
  #theme(legend.position = "bottom")

  # Use default colors and custom legend labels
  scale_fill_discrete(labels = response_labels)  # <-- just map labels

#plot_group

# Step 6: Create the caption text
caption <- textGrob("Figure 5: All group responses to QQ3 before and after ad.", 
                    gp = gpar(fontsize = 10))

# Step 7: Combine the plot and caption using grid.arrange()
#grid.arrange(fourth_plot, caption, ncol = 1, heights = c(10, 1))

# Arrange the plot and caption
arranged_grob <- arrangeGrob(plot_group, caption, ncol = 1, heights = c(10, 1))

# Draw a border and plot the arranged grobs
grid.newpage()
grid.draw(
  grobTree(
    rectGrob(gp = gpar(fill = NA, col = "black", lwd = 2)),  # This adds the border
    arranged_grob
  )
)
```

Moving onto the gender findings, it must first be noted that only females and males were included in this analysis because only 2% of participants identified with the third category, "prefer not to say", whose responses heavily skewed and shifted the data before and after an ad. Considering these two genders, females are approximately 3.25 times more likely than men to tell the truth over supporting their friends, whereas males are approximately 44% more likely than females to protect their friends (Figure 6). Overall, each gender kept the same responses for QQ3 pre- and post-ad, and agreed to nearly the same percentage, around 70%, that it's okay to tell a white lie to protect a friend.

```{r qq3_categorical_gender, fig.width=6, fig.height=3, fig.align="center", tidy=TRUE, message=FALSE, warning=FALSE, results='hide', echo=FALSE}

### CONTROLLING VALUES IN LEGEND ###

# Load necessary libraries
library(tidyverse)

# Step 1: Reshape, include Gender, relabel columns
type_of_lie_long <- lying %>%
  select(Gender, QQ3_TYPE_OF_LIE, QQ3_LIE_2_SUMMARY) %>%
  filter(Gender %in% c("Male", "Female")) %>%    # Filter for Male/Female
  pivot_longer(cols = c(QQ3_TYPE_OF_LIE, QQ3_LIE_2_SUMMARY),
               names_to = "QuestionType",
               values_to = "Response") %>%
  drop_na() %>%
  mutate(QuestionType = recode(QuestionType,
                               QQ3_TYPE_OF_LIE = "Before Ad",
                               QQ3_LIE_2_SUMMARY = "After Ad"))

# Step 2: Count and calculate percentages
lie_counts <- type_of_lie_long %>%
  group_by(Gender, QuestionType, Response) %>%
  summarise(n = n(), .groups = "drop") %>%
  group_by(Gender, QuestionType) %>%
  mutate(perc = n / sum(n) * 100)

# Step 3: Set factor levels
lie_counts$QuestionType <- factor(lie_counts$QuestionType, levels = c("Before Ad", "After Ad"))

# Step 4: Define mapping for legend labels with line breaks
response_labels <- c(
  "White Lie" = "White Lie",
  "Keeping friend from danger and/or punishment" = "Protect friend from danger\nand/or punishment",
  "Would tell truth over supporting friends" = "Would tell truth over\nsupporting friends",
  "Unsure" = "Unsure"
)

# Step 4: Create plot, faceting by Gender, using default colors
plot <- ggplot(lie_counts, aes(x = QuestionType, y = perc, fill = Response)) +
  geom_bar(stat = "identity", position = "stack", color = "black") +
  
  geom_text(aes(label = paste0(round(perc, 1), "%")),
            position = position_stack(vjust = 0.5),
            size = 3,
            color = "black") +
  
  labs(#title = "QQ3 Responses Before vs. After Ad (By Gender: Male and Female Only)",
       x = "\nResponses",
       y = "Percentage\n",
       fill = "Category") +  # Legend title
  
  facet_wrap(~ Gender) +

  # Use default colors and custom legend labels
  scale_fill_discrete(labels = response_labels) +  # <-- just map labels

  theme_minimal()

# Step 5: Print the plot
#plot

# Step 6: Create the caption text
caption <- textGrob("Figure 6: Female and male responses to QQ3 before and after ad.", 
                    gp = gpar(fontsize = 10))

# Step 7: Combine the plot and caption using grid.arrange()
#grid.arrange(fourth_plot, caption, ncol = 1, heights = c(10, 1))

# Arrange the plot and caption
arranged_grob <- arrangeGrob(plot, caption, ncol = 1, heights = c(10, 1))

# Draw a border and plot the arranged grobs
grid.newpage()
grid.draw(
  grobTree(
    rectGrob(gp = gpar(fill = NA, col = "black", lwd = 2)),  # This adds the border
    arranged_grob
  )
)
```

# Composite Score for QQ1 - QQ3

As mentioned in the Introduction, a composite score was developed to objectively measure how much a participant's response increased or decreased after watching or listening to an ad.

```{r summary_table_all_50, fig.align="center", tidy=TRUE, message=FALSE, warning=FALSE, echo=FALSE}

# Define the updated sentence-counting function
count_sentences <- function(text) {
  if (is.na(text) || trimws(text) == "") return(0)
  
  # Match sentence-ending punctuation only
  sentence_endings <- gregexpr("[.!?]+", text)
  count <- sum(sapply(sentence_endings, function(x) ifelse(x[1] == -1, 0, length(x))))
  
  # If no punctuation but text exists, count as 1 sentence
  if (count == 0 && nchar(trimws(text)) > 0) return(1)
  
  return(count)
}

# Simple word count function
count_words <- function(text) {
  if (is.na(text) || trimws(text) == "") return(0)
  return(length(unlist(strsplit(text, "\\s+"))))
}

# Compute word/sentence changes and composite score for QQ1
lying <- lying %>%
  mutate(
    word_count_day1_QQ1 = sapply(QQ1_BEFORE, count_words),
    word_count_day2_QQ1 = sapply(QQ1_AFTER, count_words),
    
    sentence_count_day1_QQ1 = sapply(QQ1_BEFORE, count_sentences),
    sentence_count_day2_QQ1 = sapply(QQ1_AFTER, count_sentences),

    word_count_change_QQ1 = (word_count_day2_QQ1 - word_count_day1_QQ1) / pmax(word_count_day1_QQ1, 1),
    sentence_count_change_QQ1 = (sentence_count_day2_QQ1 - sentence_count_day1_QQ1) / pmax(sentence_count_day1_QQ1, 1),

    composite_diff_norm_QQ1 = (word_count_change_QQ1 + sentence_count_change_QQ1) / 2
  )

# Compute word/sentence changes and composite score for QQ2
lying <- lying %>%
  mutate(
    word_count_day1_QQ2 = sapply(QQ2_BEFORE, count_words),
    word_count_day2_QQ2 = sapply(QQ2_AFTER, count_words),
    
    sentence_count_day1_QQ2 = sapply(QQ2_BEFORE, count_sentences),
    sentence_count_day2_QQ2 = sapply(QQ2_AFTER, count_sentences),

    word_count_change_QQ2 = (word_count_day2_QQ2 - word_count_day1_QQ2) / pmax(word_count_day1_QQ2, 1),
    sentence_count_change_QQ2 = (sentence_count_day2_QQ2 - sentence_count_day1_QQ2) / pmax(sentence_count_day1_QQ2, 1),

    composite_diff_norm_QQ2 = (word_count_change_QQ2 + sentence_count_change_QQ2) / 2
  )

# Step 1: Recalculate word/sentence/composite differences for QQ3
lying <- lying %>%
  mutate(
    word_count_day1_QQ3 = sapply(QQ3_BEFORE, count_words),
    word_count_day2_QQ3 = sapply(QQ3_AFTER, count_words),
    
    sentence_count_day1_QQ3 = sapply(QQ3_BEFORE, count_sentences),
    sentence_count_day2_QQ3 = sapply(QQ3_AFTER, count_sentences),

    word_count_change_QQ3 = (word_count_day2_QQ3 - word_count_day1_QQ3) / pmax(word_count_day1_QQ3, 1),
    sentence_count_change_QQ3 = (sentence_count_day2_QQ3 - sentence_count_day1_QQ3) / pmax(sentence_count_day1_QQ3, 1),

    composite_diff_norm_QQ3 = (word_count_change_QQ3 + sentence_count_change_QQ3) / 2
  )

# Step 1: Create change buckets for QQ1, QQ2, and QQ3
lying <- lying %>%
  mutate(
    change_bucket_QQ1 = case_when(
      composite_diff_norm_QQ1 < -0.5 ~ "< -50%",
      composite_diff_norm_QQ1 >= -0.5 & composite_diff_norm_QQ1 < 0 ~ "-50% to 0%",
      composite_diff_norm_QQ1 >= 0 & composite_diff_norm_QQ1 < 0.5 ~ "0% to 49%",
      composite_diff_norm_QQ1 >= 0.5 ~ ">= 50%"
    ),
    change_bucket_QQ2 = case_when(
      composite_diff_norm_QQ2 < -0.5 ~ "< -50%",
      composite_diff_norm_QQ2 >= -0.5 & composite_diff_norm_QQ2 < 0 ~ "-50% to 0%",
      composite_diff_norm_QQ2 >= 0 & composite_diff_norm_QQ2 < 0.5 ~ "0% to 49%",
      composite_diff_norm_QQ2 >= 0.5 ~ ">= 50%"
    ),
    change_bucket_QQ3 = case_when(
      composite_diff_norm_QQ3 < -0.5 ~ "< -50%",
      composite_diff_norm_QQ3 >= -0.5 & composite_diff_norm_QQ3 < 0 ~ "-50% to 0%",
      composite_diff_norm_QQ3 >= 0 & composite_diff_norm_QQ3 < 0.5 ~ "0% to 49%",
      composite_diff_norm_QQ3 >= 0.5 ~ ">= 50%"
    )
  )

# Helper function to summarize for one QQ
summarize_bucket <- function(df, bucket_col, bucket_name) {
  df %>%
    group_by(GROUP, .data[[bucket_col]]) %>%
    summarise(count = n(), .groups = "drop") %>%
    group_by(GROUP) %>%
    mutate(percentage = round(100 * count / sum(count), 1)) %>%
    filter(.data[[bucket_col]] %in% c("< -50%", ">= 50%")) %>%
    select(GROUP, !!bucket_col := .data[[bucket_col]], percentage) %>%
    pivot_wider(
      names_from = !!sym(bucket_col),
      values_from = percentage,
      values_fill = 0
    ) %>%
    rename_with(~ paste(bucket_name, ., sep = ": "), -GROUP)
}

# Create individual summaries for QQ1, QQ2, QQ3
summary_QQ1 <- summarize_bucket(lying, "change_bucket_QQ1", "QQ1")
summary_QQ2 <- summarize_bucket(lying, "change_bucket_QQ2", "QQ2")
summary_QQ3 <- summarize_bucket(lying, "change_bucket_QQ3", "QQ3")

# Join into one combined table
final_combined <- summary_QQ1 %>%
  full_join(summary_QQ2, by = "GROUP") %>%
  full_join(summary_QQ3, by = "GROUP")

# View
#final_combined

# Print table nicely
library(knitr)
library(kableExtra)

#final_combined %>%
#  kable(format = "latex", booktabs = TRUE, digits = 1, caption = "Summary of Changes by Group and Question") %>%
#  kable_styling(latex_options = c("hold_position", "striped"))

final_combined %>%
  kable("latex", booktabs = TRUE, digits = 1, caption = "Summary of Changes by Group and Question") %>%
  kable_styling(latex_options = c("hold_position", "striped"), position = "center", full_width = FALSE, font_size = 8.5)
```

# Sentiment Analysis of Ads

# Other Project?

This didn't pan out. The link is here, and is in the GitHub repository:

# Limitations & Future Discussions

### Cut stuff:

Additionally, if a different advertisement was presented to participants then the views may or may not change based on the emotional impact an ad may have. The thematic analysis is also the views, as objective as possible, of just one person.

This will be good to create categories for quicker analysis, especially if multiple studies want to be ran at once, and scaled up to occur more frequently. This pilot is a starting point, and additional comments can be left.

In summary, no correlation was found between the type of ad and categorical responses changing, although the composite score always increased whenever participants were show an audio-visual ad, whether a control or test ad. When the data was analyzed based on gender instead of ad group, there were slight contrasting views in how males and females answered a question, but overall, participants' views remained mostly unchanged before and after an ad.

Many themes were combined together that have some type of relationship and influence on one another. For example,

the categories in QQ1 have been combined that has some influence on each other. For example, with the largest category, 4 - Confirmation bias, people want to seek a community of like-minded people, "confirmation bias" means they're seeking people and sources that match their views. In other words, misinformation usually isn't objective and factual, but information that has been filtered subjectively or completely made up and seems real.

This question asked people their views on relationships, specifically how people form social bonds with radical people, therefore it's possible that many themes appeared to explain this complex, multi-faceted dynamic.
