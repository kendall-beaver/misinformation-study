---
title: "Capstone Report - Backup"
author: "Kendall Beaver"
date: "`r Sys.Date()`"
output: pdf_document
---

## Entertainment Podcasts

```{r entertainment_podcasts, tidy=TRUE, message=FALSE, warning=FALSE, results='hide', echo=FALSE}

### PODCASTST ###

# I noticed there's different spellings of Joe Rogan. 
# Need to get different variations of spelling on the
# same page.

# Step 1: Convert to lowercase for consistency
cleaned <- tolower(lying$`Top 3 Entertainment_1`)

# Step 2: Clean up repeated "the"s at the start
cleaned <- gsub("^(the\\s+)+", "", cleaned)

# Step 3: Identify any Joe Rogan Experience variations and replace them
cleaned <- gsub("joe\\s*rogan.*exper.{2,}", "The Joe Rogan Experience", cleaned)

# Optional Step 4: Tidy up any leftover whitespace
cleaned <- trimws(cleaned)

# Step 5: Save it back to the original column
lying$`Top 3 Entertainment_1` <- cleaned

# Clean and standardize podcast names (ensure "joe rogan" is handled here)
lying <- lying %>%
  mutate(`Top 3 Entertainment_1` = case_when(
    str_detect(str_to_lower(`Top 3 Entertainment_1`), "call.?her.?dad") ~ "Call Her Daddy",
    str_detect(str_to_lower(`Top 3 Entertainment_1`), "pat mcafee.*show|pat mcafee.*talk") ~ "The Pat McAfee Show",
    str_detect(str_to_lower(`Top 3 Entertainment_1`), "cancelled.*tana|canceled|cancelled") ~ "Cancelled with Tana Mongeau",
    str_detect(str_to_lower(`Top 3 Entertainment_1`), "anything goes") ~ "Anything Goes",
    str_detect(str_to_lower(`Top 3 Entertainment_1`), "hot.?mess.*alex") | 
      str_to_lower(`Top 3 Entertainment_1`) == "hotmess" ~ "Hot Mess by Alex Earle",
    str_detect(str_to_lower(`Top 3 Entertainment_1`), "joe\\s*rogan") ~ "The Joe Rogan Experience",  # Added this line to catch "joe rogan"
    TRUE ~ `Top 3 Entertainment_1`
  ))

unique(na.omit(lying$`Top 3 Entertainment_1`))
# 42 different podcasts

length(unique(na.omit(lying$`Top 3 Entertainment_1`)))
# 42 different podcasts
```
