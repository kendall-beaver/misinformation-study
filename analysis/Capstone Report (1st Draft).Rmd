---
title: "Capstone Report (Final Draft)"
author: "Kendall Beaver"
date: "`r Sys.Date()`"
output: pdf_document
---

# Outline

## Intro

## Demographics

1.  Overview of participants
    1.  149 students partook in Part I, but only 99 students wait until Part 2.
2.  Charts of
    1.  Political Party?
    2.  **Age & Gender (side-by-side)**
    3.  **News Source/Information & Hours online (side-by-side)**

## Qualitative Questions Analysis

1.  QQ1 After Ad (Did views and length change?)
2.  QQ2 After Ad
3.  QQ3 After Ad

## Test Score Analysis

1.  GBCS
2.  MIST-20
3.  IT-MIST

## Additional Sentiment Discovered From Other Questions

1.  Sentiment towards ads
2.  Sentiment about participating in future studies

## GenAI Study & Results

## Future Direction

And yes, audio ads are not a great way to reach people, though they may still be effective in more typical listening conditions. In future work, ideally, we would have participants queue up media they already planned to listen to, and then embed our ad in it while they engage however they usually do (exercising, cleaning, driving).

I'm glad Video ads are still showing promise on deeper analysis. We should pursue that in ads on YouTube podcasts, since many cannot skip those.More testing might be good first, ideally targeting more specific falsehoods and problems.

## References

-------

# Intro

```{r load_libraries, tidy=TRUE, message=FALSE, warning=FALSE, results='hide', echo=FALSE}

# Load libraries
library(tidyr)
library(gridExtra)
library(readxl)
library(dplyr)
library(corrplot)
library(writexl)
library(ggplot2)
library(gt)

# Load datasets

lying <- read_excel("data/lying_data.xlsx")
```

1.  Intro of misinformation and purpose of study, to study the prebunking effects using comedy sketch ads to see how effective they will be.
2.  Two different ads
    1.  Control ad: Was not a neutral ad. It was an ad with negative emotion, which is impactful but confused the results. In the future a neutral ad will be chosen, in terms of content, tone and emotion.
        1.  The United States Post Office. Every now and then, something good happens here." This ad is about two friends waiting in line, or at least Jessica takes a number to wait. Jessica and Mel: Jessica has just completed bowling with her friends because they're morning people. What can you do? Mel jokes and says she can get new friends, and she snaps, then apologizes. She says her fingers were too small and she was kicked out. Mel acknowledges that that sucks, then he invites her to come hang with his karaoke friends at night, to which Jessica displays interest. Then it cuts to her singing and having fun. So completely random.
3.  Method: used Descript program to create ads.
4.  My help/work needed: Looking at qualitative questions that was asked before viewing the ad and after reviewing the ad.

# Demographics

```{r age_pie_charts, tidy=TRUE, message=FALSE, warning=FALSE, results='hide', echo=FALSE}

### AGE PIE CHART ###

#range(lying$Age, na.rm = TRUE)
# 18 - 48 years old

# Bin:
# 18 - 19
# 20 - 29
# 30 - 39
# 40 - 49

# 1. Create age bins
age_bins <- cut(lying$Age,
                breaks = c(17, 19, 29, 39, 49),
                labels = c("18–19", "20–29", "30–39", "40–49"),
                right = TRUE)

# 2. Create dataframe with counts & percentages
age_counts <- as.data.frame(table(age_bins))
colnames(age_counts) <- c("AgeGroup", "Count")

age_counts <- age_counts %>%
  mutate(Percent = round(Count / sum(Count) * 100, 1),
         Label = paste0(Percent, "%"))

# 3. Plot with percentage labels, black borders, and reduced font size
ggplot(age_counts, aes(x = "", y = Count, fill = AgeGroup)) +
  geom_bar(stat = "identity", width = 1, color = "black") +  # Black border around slices
  coord_polar(theta = "y") +
  theme_void() +
  labs(title = "Age Distribution in Bins") +
  theme(legend.title = element_blank()) +
  
  # 4. Add text for larger slices (inside the pie)
  geom_text(aes(label = ifelse(AgeGroup %in% c("18–19", "20–29"), Label, "")), 
            position = position_stack(vjust = 0.5), 
            color = "black", size = 4) +  # Reduced font size
  
  # 5. Add text for smaller slices (outside the pie)
  geom_text(aes(label = ifelse(AgeGroup == "30–39", Label, "")),
            position = position_nudge(x = 0.2),  # Adjust x to move the text for 30–39
            color = "black", size = 4) +  # Reduced font size
  
  geom_text(aes(label = ifelse(AgeGroup == "40–49", Label, "")),
            position = position_nudge(x = 0.35),  # Adjust x to move the text for 40–49
            color = "black", size = 4) +  # Reduced font size
  
  theme(plot.title = element_text(hjust = 0.5))  # Center the title
```

```{r average_time_to_complete_study, tidy=TRUE, message=FALSE, warning=FALSE, results='hide', echo=FALSE}


```

```{r itmist_box_2, tidy=TRUE, message=FALSE, warning=FALSE, results='hide', echo=FALSE, fig.align='center', results='asis'}

# Define custom labels for groups
group_titles <- c(
  "1" = "VISUAL AD", # Test Group (Visual)
  "2" = "VISUAL AD", # Control Group (Visual)
  "3" = "AUDIO AD", # Test Group (Audio)
  "4" = "AUDIO AD" # Control Group (Audio)
)

# Reshape the data to long format for easier faceting
long_data <- misinfo_filtered %>%
  # Convert both "ITMIST PRE SCORE" and "ITMIST POST SCORE" to numeric
  mutate(
    `ITMIST PRE SCORE` = as.numeric(`ITMIST PRE SCORE`),
    `ITMIST POST SCORE` = as.numeric(`ITMIST POST SCORE`)
  ) %>%
  select(GROUP, `ITMIST PRE SCORE`, `ITMIST POST SCORE`) %>%  # Updated column names here
  pivot_longer(cols = c(`ITMIST PRE SCORE`, `ITMIST POST SCORE`), 
               names_to = "Test_Time", 
               values_to = "Score") %>%
  mutate(Test_Time = factor(Test_Time, levels = c("ITMIST PRE SCORE", "ITMIST POST SCORE")))  # Updated levels

# Create the plot for Groups 2 and 4 (Control Group)
plot2 <- ggplot(long_data %>% filter(GROUP %in% c(2, 4)), aes(x = Test_Time, y = Score, fill = Test_Time)) +
  geom_boxplot(outlier.colour = "red", outlier.shape = 16, outlier.size = 2) +
  facet_wrap(~ GROUP, labeller = as_labeller(group_titles)) +  # Only for Groups 2 and 4
  labs(
    title = "ITMIST Scores Before & After Ad - Control Group\n",  # Updated title for ITMIST
    x = "\nITMIST Test Scores",  # Updated axis label for ITMIST
    y = "Score\n"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
    legend.position = "none"
  )

# Use grid.arrange to display the plot
grid.arrange(plot2)  # Display the plot for Control Groups (2 & 4)
```

# II: Analysis of Qualitative Questions

This didn't effect anybody across all of the categories.

```{r table_of_previous, tidy=TRUE, message=FALSE, warning=FALSE, results='hide', echo=FALSE, fig.align='center', results='asis'}

lie_counts_wide <- lie_counts %>%
  select(GROUP, QuestionType, Response, n) %>%
  pivot_wider(names_from = Response, values_from = n, values_fill = 0)

# Then use gt or kable
lie_counts_wide %>%
  gt()
```

## **QQ1 - Content/View of Answer**

```{r bar_chart_1, tidy=TRUE, message=FALSE, warning=FALSE, results='hide', echo=FALSE, fig.align='center', results='asis'}

# Prepare data for stacked bar chart
stacked_data <- misinfo_filtered %>%
  count(GROUP, CHANGED_LENGTH_QQ1) %>%
  group_by(GROUP) %>%
  mutate(percentage = n / sum(n) * 100) %>%  # Convert to percentage
  ungroup()

# Ensure GROUP and CHANGED_LENGTH_QQ1 are factors for proper ordering
stacked_data$GROUP <- factor(stacked_data$GROUP, levels = c("1", "2", "3", "4"))
stacked_data$CHANGED_LENGTH_QQ1 <- factor(stacked_data$CHANGED_LENGTH_QQ1, levels = c("1", "2", "3"))

# Define custom labels for groups
group_titles <- c(
  "1" = "Test Group (Visual)",
  "2" = "Control Group (Visual)",
  "3" = "Test Group (Audio)",
  "4" = "Control Group (Audio)"
)

# Define labels for CHANGED_LENGTH_QQ1
view_labels <- c("1" = "Length stayed about the same",
                 "2" = "Length became longer",
                 "3" = "Length became shorter")

# Custom colors
custom_colors <- c("skyblue", "red", "orange")

# Create the stacked bar chart
stacked_bar_chart <- ggplot(stacked_data, aes(x = GROUP, y = percentage, fill = CHANGED_LENGTH_QQ1)) +
  geom_bar(stat = "identity", color = "black") +  # Stacked bars with black borders
  geom_text(aes(label = paste0(round(percentage, 1), "%")), 
            position = position_stack(vjust = 0.5),  # Position labels in center of bars
            color = "black", size = 4) +  # Adjust label size and color
  labs(
    title = "Change in QQ1 Comment Length After\nExposed to Ad",
    x = "\nGroup",
    y = "Percentage\n",
    fill = "Comment Length"
  ) +
  scale_x_discrete(labels = group_titles) +  # Map numeric groups to names
  scale_fill_manual(values = custom_colors, labels = view_labels) +  # Apply colors and labels
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),  # Center and style the title
    axis.text.x = element_text(angle = 30, hjust = 1),  # Tilt x-axis labels for readability
    legend.position = "right",  # Keep legend visible
    legend.title = element_text(face = "bold"),
    legend.text = element_text(size = 10)
  )

# Print the stacked bar chart
print(stacked_bar_chart)
```

## QQ3: Change in Views of Answer (%)

```{r qq3_stacked_bars_change_in_answer_percentage, tidy=TRUE, message=FALSE, warning=FALSE, results='hide', echo=FALSE}

# Step 1: Reshape, include GROUP, relabel columns
type_of_lie_long <- lying %>%
  select(GROUP, QQ3_TYPE_OF_LIE, QQ3_LIE_2_SUMMARY) %>%
  pivot_longer(cols = c(QQ3_TYPE_OF_LIE, QQ3_LIE_2_SUMMARY),
               names_to = "QuestionType",
               values_to = "Response") %>%
  drop_na() %>%
  mutate(QuestionType = recode(QuestionType,
                               QQ3_TYPE_OF_LIE = "Before Ad",
                               QQ3_LIE_2_SUMMARY = "After Ad"))

# Step 2: Count and calculate percentages for each GROUP
lie_counts <- type_of_lie_long %>%
  group_by(GROUP, QuestionType, Response) %>%
  summarise(n = n(), .groups = "drop") %>%
  group_by(GROUP, QuestionType) %>%
  mutate(perc = n / sum(n) * 100)

# Step 3: Set factor levels for consistent x-axis order
lie_counts$QuestionType <- factor(lie_counts$QuestionType, levels = c("Before Ad", "After Ad"))

# Step 4: Create one plot per GROUP
plot_list <- lapply(unique(lie_counts$GROUP), function(g) {
  ggplot(filter(lie_counts, GROUP == g), aes(x = QuestionType, y = n, fill = Response)) +
    geom_bar(stat = "identity", position = "stack", color = "black") +
    geom_text(aes(label = paste0(round(perc, 1), "%")),
              position = position_stack(vjust = 0.5),
              size = 3,
              color = "black") +
    labs(title = paste("Group:", g),
         x = "\nResponses",
         y = "Count\n") +
    theme_minimal() #+
    #theme(axis.text.x = element_text(angle = 15, hjust = 1))
})

# Step 5: Print each plot
plot_list[[1]]  # Control Group (Visual)
plot_list[[2]]  # Test Group (Visual)
plot_list[[3]]  # Control Group (Audio)
plot_list[[4]]  # Test Group (Audio)
```

```{r qq3_stacked_bars_change_in_answer_count, tidy=TRUE, message=FALSE, warning=FALSE, results='hide', echo=FALSE}

# Step 1: Reshape, include GROUP, relabel columns
type_of_lie_long <- lying %>%
  select(GROUP, QQ3_TYPE_OF_LIE, QQ3_LIE_2_SUMMARY) %>%
  pivot_longer(cols = c(QQ3_TYPE_OF_LIE, QQ3_LIE_2_SUMMARY),
               names_to = "QuestionType",
               values_to = "Response") %>%
  drop_na() %>%
  mutate(QuestionType = recode(QuestionType,
                               QQ3_TYPE_OF_LIE = "Before Ad",
                               QQ3_LIE_2_SUMMARY = "After Ad"))

# Step 2: Count and calculate percentages for each GROUP
lie_counts <- type_of_lie_long %>%
  group_by(GROUP, QuestionType, Response) %>%
  summarise(n = n(), .groups = "drop") %>%
  group_by(GROUP, QuestionType) %>%
  mutate(perc = n / sum(n) * 100)

# Step 3: Set factor levels for consistent x-axis order
lie_counts$QuestionType <- factor(lie_counts$QuestionType, levels = c("Before Ad", "After Ad"))

# Step 4: Create one plot per GROUP
plot_list <- lapply(unique(lie_counts$GROUP), function(g) {
  ggplot(filter(lie_counts, GROUP == g), aes(x = QuestionType, y = n, fill = Response)) +
    geom_bar(stat = "identity", position = "stack", color = "black") +
    geom_text(aes(label = n),
              position = position_stack(vjust = 0.5),
              size = 3,
              color = "black") +
    labs(title = paste("Group:", g),
         x = "\nResponses",
         y = "Count\n") +
    theme_minimal()
})

# Step 5: Print each plot
plot_list[[1]]  # Control Group (Visual)
plot_list[[2]]  # Test Group (Visual)
plot_list[[3]]  # Control Group (Audio)
plot_list[[4]]  # Test Group (Audio)
```

There were four main responses to QQ3:

1.  White Lie
2.  Keeping friend from danger and/or punishment
3.  Would tell truth over supporting friends
4.  Unsure

While the Test Group (Audio) went from 7.1% to 14.3%, everything stayed exactly the same except for "Unsure."

The Control Group (Audio) seems to have had some effect on the getting respondants to put a different answer, "Keeping friend from danger and/or punishment" to "White Lie," dropping by 25% and increasing by 7.8%.

# References
